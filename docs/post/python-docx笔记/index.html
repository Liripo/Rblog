<!DOCTYPE html>
<html lang="Zh-cn">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>python-docx笔记 | Liripo</title>
    <link rel="shortcut icon" href="../../image/title.svg" type="image/x-icon">
  <script src="../../fontawesome-free-5.11.2-web/fontawesome-free-5.11.2-web/js/all.js" crossorigin="anonymous"></script>

  <style>
  	:root {
  		--pagecolour: #333333;
  		--maintext: #dddddd;
  		--faded: #888888;
  		--highlight: #6BB0DF;
  		--lowlight: #ba68c8;
	}
  </style>

  <link rel="stylesheet" href="../../css/et_book.css" />
  <link rel="stylesheet" href="../../css/style.css" />

  
<meta name="twitter:card" content="summary">
<meta property="og:title" content="python-docx笔记">




</head>


  <body>
    



    <div class="main-content">
      <nav>
  <ul class="menu">
    
    <li><a href="../../">Home</a></li>
    
    <li><a href="../../about/">About</a></li>
    
    <li><a href="../../post/">Posts</a></li>
    
    <li><a href="../../tags/">Tags</a></li>
    
  </ul>
</nav>

      <div>
  <h1>python-docx笔记</h1>
  <h3>
    12 Feb 2020
  </h3>
   <h5 id="wc">1017 Words|Read in about 3       Min|本文总阅读量<span id="busuanzi_value_page_pv"></span>次</h5>
    </h5>
  <br><br>
</div>


      <main>
        

        <blockquote>
<p>docx文件是office2007之后的版本使用的，docx格式的文件本质上是一个zip文件，主要内容是保存为XML格式的，因此可以通过修改Word背后的XML文件来设置自动更新域 。</p>
</blockquote>
<blockquote>
<p>python-docx是一个用于创建和更新Microsoft Word（.docx）文件的Python库 。</p>
</blockquote>
<p><a href="https://www.zybuluo.com/belia/note/1303813">中文教程，分享的cmd笔记</a></p>
<p><a href="https://python-docx.readthedocs.io/en/latest/index.html">官方文档</a></p>
<p>首先，谈谈一份word的组成部分，其基本是由标题，段落，表格，图片，分页，页眉页脚，目录，文本框，形状，章节，然后就是文字字体，字号等。【python-docx目前貌似还没有目录以及文本框的相关操作，所以对于涉及这两方面的暂时无法使用python-docx操作】</p>
<p>当你将一份word模板使用函数 Document() 打开，或者新建一份空白文档时，你就得到了一个文档对象，如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> docx <span style="color:#f92672">import</span> Document
document <span style="color:#f92672">=</span> Document()
</code></pre></div><p>对于对象<code>document</code>即word文档，其势必由上述所述的部分组成，其中最基本的即是段落，可以使用<code>add_paragraph</code>方法添加段落，而对于一个已存在的段落而言，如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">paragraph <span style="color:#f92672">=</span> document<span style="color:#f92672">.</span>add_paragraph(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Lorem ipsum dolor sit amet.</span><span style="color:#e6db74">&#39;</span>)
paragraph<span style="color:#f92672">.</span>style <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">List Bullet</span><span style="color:#e6db74">&#39;</span>
</code></pre></div><p>在空白文档加入段落，或者获取模板第四个段落<code>paragraph = document.paragraphs[3]</code>，可以在其后面使用add_run方法添加文字获得一个run对象，添加的字符格式是默认的，这时你可以对这个run进行字体加粗，斜体，字体名等操作，如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">run <span style="color:#f92672">=</span> paragraph<span style="color:#f92672">.</span>add_run(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dolor</span><span style="color:#e6db74">&#39;</span>)
run<span style="color:#f92672">.</span>bold <span style="color:#f92672">=</span> True
<span style="color:#75715e">#英文字体名修改</span>
run<span style="color:#f92672">.</span>font<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">黑体</span><span style="color:#e6db74">&#39;</span>
<span style="color:#75715e">#中文字体名修改</span>
chinese <span style="color:#f92672">=</span> qn(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">w:eastAsia</span><span style="color:#e6db74">&#39;</span>)
run<span style="color:#f92672">.</span>_element<span style="color:#f92672">.</span>rPr<span style="color:#f92672">.</span>rFonts<span style="color:#f92672">.</span>set(chinese, <span style="color:#e6db74">u</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">黑体</span><span style="color:#e6db74">&#39;</span>) <span style="color:#75715e">#u为unicode编码</span>
</code></pre></div><p>当然，你也可以修改段落的style,但是我在实践中遇到字体无法修改的情况，可以自行尝试。</p>
<p>标题添加就不说了，一般报告模板都会有的，但是记住，标题也是属于一个段落。</p>
<p>对于表格，你可在段落<code>paragraphs</code>处使用方法<code>add_table</code>添加，在整篇文档段落计算时，表格不属于段落，反倒是添加的表格由行列，单元格组成，而单元格之中又包含了段落，段落中又可以使用run对象进行操作。</p>
<p>说个例子，实际中我为了将自动化生成的表格文字单元格居中费了不少功夫。</p>
<p>首先我们需要找到官网的说明文档，找到cell即单元格这个对象，我们会发现，它有一些方法去修改这个单元格，</p>
<p>vertical_alignment这个方法，而对于居中，还是向上靠均存在WD_CELL_VERTICAL_ALIGNMENT这个预设好的对象里，而通过调用居中的方法即可实现单元格居中，如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> docx.enum.table <span style="color:#f92672">import</span> WD_CELL_VERTICAL_ALIGNMENT
cell<span style="color:#f92672">.</span>vertical_alignment <span style="color:#f92672">=</span> WD_CELL_VERTICAL_ALIGNMENT<span style="color:#f92672">.</span>CENTER
</code></pre></div><p>具体学习看官方文档即可。</p>
      </main>

      <footer>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/python.min.js"></script>

  <script>
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  </script>
  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id       ="busuanzi_value_site_pv"></span>次</span>
  <span id="busuanzi_container_site_uv">
    本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
  
  
<script async src="../../js/center-image.js"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<center>
Liripo <SPAN id=span_dt_dt style="color: #0196e3;"></SPAN>
<SCRIPT language=javascript>
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("7/8/2019 00:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=Math.floor(e_hrsold);
e_minsold=(e_hrsold-hrsold)*60;
minsold=Math.floor((e_hrsold-hrsold)*60);
seconds=Math.floor((e_minsold-minsold)*60);
span_dt_dt.innerHTML=""+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
show_date_time();
</SCRIPT>
</center>
  
</footer>


    </div>
  </body>
</html>
