<!DOCTYPE html>
<html lang="">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>sed使用 | Liripo</title>

  <style>
  	:root {
  		--pagecolour: #333333;
  		--maintext: #dddddd;
  		--faded: #888888;
  		--highlight: #ff69b4;
  		--lowlight: #ba68c8;
	}
  </style>

  <link rel="stylesheet" href="../../css/et_book.css" />
  <link rel="stylesheet" href="../../css/style.css" />

  
<meta name="twitter:card" content="summary">
<meta property="og:title" content="sed使用">
<meta property="og:description" content="
sed 命令是一个面向行处理的工具，它以“行”为处理单位，针对每一行进行处理。与awk不同，awk是以”列“为处理单位[当然，awk也是一行行进行处理的]。
在线教程
">
<meta property="og:image" content="https://djnavarro.github.io/hugo-calade/header/caladown.png">

</head>


  <body>
    



    <div class="main-content">
      <nav>
  <ul class="menu">
    
    <li><a href="../../">Home</a></li>
    
    <li><a href="../../about/">About</a></li>
    
    <li><a href="../../post/">Posts</a></li>
    
    <li><a href="../../tags/">Tags</a></li>
    
  </ul>
</nav>

      <div>
  <h1>sed使用</h1>
  <h3>
    , 11 Nov 2019
  </h3>
  <br><br>
</div>


      <main>
        

        <blockquote>
<p>sed 命令是一个面向行处理的工具，它以“行”为处理单位，针对每一行进行处理。与awk不同，awk是以”列“为处理单位[当然，awk也是一行行进行处理的]。
<a href="https://man.linuxde.net/sed%E5%9C%A8%E7%BA%BF%E6%95%99%E7%A8%8B">在线教程</a></p>
</blockquote>
<p>sed命令格式</p>
<blockquote>
<p>sed [options] &lsquo;command&rsquo; file(s)
sed [options] -f scriptfile file(s)</p>
</blockquote>
<h1 id="heading">工作流</h1>
<p><strong>读取</strong>： SED从输入流（文件，管道或者标准输入）中读取一行并且存储到它叫做 模式空间（<strong>pattern buffer</strong>） 的内部缓冲区</p>
<p><strong>执行</strong>： 默认情况下，所有的SED命令都在<strong>模式空间</strong>中顺序的执行，除非指定了行的地址，否则SED命令将会在所有的行上依次执行</p>
<p><strong>显示</strong>： 发送修改后的内容到输出流。在发送数据之后，<strong>模式空间</strong>将会被清空。</p>
<h1 id="--help">&ndash;help</h1>
<p><a href="http://linux.51yip.com/search/sed">中文帮助文档</a>
选项：
-i 参数可以直接对文件进行修改，虽然好用，但是记住你要知道你在干嘛
-n 参数使得sed不从模式空间输出，只有遇到如5p时，才输出第五行内容。
-e 多次使用sed
命令：
p打印；d删除；s替换
g:全局性 ； i 忽略大小写</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#删除第一行，和最后一行</span>
sed -i -e <span style="color:#e6db74">&#39;1d&#39;</span> -e <span style="color:#e6db74">&#39;$d&#39;</span> 1.txt
<span style="color:#75715e">#打印1到2行</span>
sed <span style="color:#e6db74">&#39;1,2p&#39;</span> 1.txt
<span style="color:#75715e">#删除所有空行</span>
sed <span style="color:#e6db74">&#39;/^$/d&#39;</span> 1.txt
<span style="color:#75715e">#全局替换</span>
echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>
<span style="color:#75715e">#试试下面这个</span>
echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>|sed <span style="color:#e6db74">&#39;s/\n/,/g&#39;</span>
<span style="color:#75715e">#失败了，没有替换换行符。这跟sed的行处理方式有关，sed读取一行时，会先把换行符去掉，处理完后再添加上</span>
<span style="color:#75715e"># 用tr命令</span>
echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>|tr -t <span style="color:#e6db74">&#39;\n&#39;</span> <span style="color:#e6db74">&#39;,&#39;</span>
</code></pre></div><p>为了用sed处理换行符，使用标签跳转和N
<code>sed ':label;N;s/\n/:/;b label' filename</code>b可以换成t
:label;这是一个标签，用来实现跳转处理，名字可以随便取(label),后面的b label就是跳转指令
N是sed的一个处理命令，追加文本流中的下一行到模式空间进行合并处理，因此是换行符可见
比如fastq文件每四行为一个循环，我们提取序列行试试</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sed -n <span style="color:#e6db74">&#39;1d;N;N;N;P;d&#39;</span> 1.fastq#删除第一行，追加后面三行，打印第二行，删除
</code></pre></div><p>标签跳转和N的追加命令实现了每一行的不间断放入模式处理空间，从而不会漏掉每一个换行符。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>|sed <span style="color:#e6db74">&#39;:x;N;s/\n/,/;b x&#39;</span><span style="color:#75715e">#a,b,c,d</span>
$ echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>|sed <span style="color:#e6db74">&#39;N;s/\n/,/&#39;</span>
a,b
c,d
</code></pre></div><p>看看这个命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;a,b,c,d&#34;</span> |sed <span style="color:#e6db74">&#39;s/,/\n/g&#39;</span>|sed <span style="color:#e6db74">&#39;s/$/,/&#39;</span>
a,
b,
c,
d,
<span style="color:#75715e">#你可以在最后替换时不使用管道而是重定向输入文件，cat -A 文件 就大概了解了</span>
</code></pre></div><p>sed中的n和~</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sed <span style="color:#e6db74">&#39;8,80{n;n;n;d}&#39;</span> filename
<span style="color:#75715e">#从第8行起（包含），一次读取9/10/11行，然后读取11行后，执行d命令，就是删除处理空间中的第11行，之后从12行开始，读取13/14/15, 删除15行，以此类推，直到第80行。</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sed <span style="color:#e6db74">&#39;11~4d&#39;</span> filename
<span style="color:#75715e">#实现同样效果，只是无法界定最后行数，读取直到文件结束。</span>
</code></pre></div><p>n表示读取文本流中的下一行到模式空间(N为追加)</p>
      </main>

      <footer>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>

  <script>
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  </script>

  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  
  <br/><br/>
  Build by blogdown and the theme of calade.
  <br/><br/>
  
</footer>


    </div>
  </body>
</html>
